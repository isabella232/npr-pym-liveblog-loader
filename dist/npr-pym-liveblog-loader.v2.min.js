/*! npr-pym-liveblog-loader.js - v2.0.0 - 2017-07-05 */

!function(a,b){var c=[],d=function(a){var b=document.createEvent("Event");b.initEvent("npr-pym-liveblog-loader:"+a,!0,!0),document.dispatchEvent(b)},e=function(){var a=/^https?:\/\/(www(-s1)?\.)?npr\.org/;return!!window.location.href.match(a)},f=function(a){var b=document.createElement("a");b.style.display="none",b.setAttribute("href",a),document.getElementById("main-section").appendChild(b),b.click(),b.parentNode.removeChild(b)},g=function(a,b){if(a){b||d("pym-loaded");for(var g=document.querySelectorAll("[data-pym-liveblog-loader]:not([data-embed-loaded])"),h=0;h<g.length;++h)null!==g[h].getAttribute("id")?null!==g[h].getAttribute("data-child-src")?(!function(){var b=g[h],d=new a.Parent(b.getAttribute("id"),b.getAttribute("data-child-src"),{});b.setAttribute("data-embed-loaded",""),e()&&d.onMessage("pjax-navigate",f),c.push(d)}(),window.npr_pym_liveblog_loader_loading=void 0):console.error("container element does not have a data-child-src attribute"):console.error("container element does not have an id attribute");return!0}return!1},h=function(a){0!==this.el.getElementsByTagName("iframe").length&&this.sendMessage("on-screen",a)},i=function(){var a=location.hash;0!==this.el.getElementsByTagName("iframe").length&&this.sendMessage("visibility-available",a)},j=function(a){this.trackers[a].stopTracking(),delete this.trackers[a]},k=function(a){a=+a;var b=/\((\d+)\)(.*)/.exec(document.title);if(b){var c=+b[1];c=a?c+a:a,document.title=c>0?"("+c+")"+b[2]:b[2].trim()}else a>0&&(document.title="("+a+") "+document.title)},l=function(a,b){var c={};if(a){var d=new a.VisibilityTracker(this,b,h.bind(this,b),c);this.trackers[b]=d}else{var e=new window.ChildTracker.VisibilityTracker(this,b,h.bind(this,b),c);this.trackers[b]=e}},m=function(a,b,e){if(a){e||d("tracker-loaded");for(var f=c,g=0;g<f.length;++g)!function(){var a=f[g];a.trackers={},a.onMessage("test-visibility-tracker",i),a.onMessage("remove-tracker",j),a.onMessage("request-tracking",l.bind(a,b)),a.onMessage("update-parent-title",k)}()}},n="https://pym.nprapps.org/pym.v1.min.js",o="https://carebot.nprapps.org/child-tracker.v2.min.js";window.npr_pym_liveblog_loader_loading||(window.npr_pym_liveblog_loader_loading=!0,function(b,c){if(void 0!==a){b=b.split(".js")[0],c=c.split(".js")[0];var d={pym:b,tracker:c},e={pym:{exports:"pym"},tracker:{exports:"tracker"}},f=["require","pym","tracker"],h="context_liveblog_"+b.split("/").slice(-1)[0];return a.config({context:h,paths:d,shim:e})(f,function(a,b,c){g(b),m(b,c)}),!0}return!1}(n,o)||function(a,c){return void 0!==b&&"function"==typeof b.getScript&&(b.getScript(a).done(function(){b(function(){g(window.pym),b.getScript(c).done(function(){m(window.pym)})})}).fail(function(){console.error("could not load pym with jQuery"),window.npr_pym_liveblog_loader_loading=void 0}),!0)}(n,o)||function(a,b){var c=document.getElementsByTagName("head")[0],d=document.createElement("script");d.type="text/javascript",d.src=a,d.onload=function(){c&&d.parentNode&&c.removeChild(d),g(window.pym),c=document.getElementsByTagName("head")[0];var a=document.createElement("script");a.type="text/javascript",a.src=b,a.onload=function(){c&&a.parentNode&&c.removeChild(a),m(window.pym)},c.appendChild(a)},d.onerror=function(){console.error("could not append pym via embedding"),window.npr_pym_liveblog_loader_loading=void 0},c.appendChild(d)}(n,o))}(window.requirejs,window.jQuery);